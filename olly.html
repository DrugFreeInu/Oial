<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Olly — String</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  background: transparent;
  overflow: hidden;
}
canvas { display:block; }
</style>
</head>
<body>
<canvas id="c"></canvas>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");

let w,h;
function resize(){
  w = canvas.width = innerWidth;
  h = canvas.height = innerHeight;
}
addEventListener("resize", resize);
resize();

/* ───────── MOTION SOURCE (ARM / BODY) ───────── */
const motion = {
  x: w*0.5,
  y: h*0.5,
  vx: 0,
  vy: 0,
  nextDrift: performance.now() + 1600
};

function drift(){
  const a = Math.random()*Math.PI*2;
  const f = 0.15 + Math.random()*0.35;
  motion.vx += Math.cos(a)*f;
  motion.vy += Math.sin(a)*f;
  motion.nextDrift = performance.now() + 1800 + Math.random()*2200;
}

/* ───────── PARTICLES (STRING SEGMENTS) ───────── */
const COUNT = 160;
const particles = [];

for(let i=0;i<COUNT;i++){
  particles.push({
    x: Math.random()*w,
    y: Math.random()*h,
    vy: 0.4 + Math.random()*0.8,
    sway: Math.random()*Math.PI*2,
    len: 10 + Math.random()*22,
    alpha: 0.05 + Math.random()*0.08
  });
}

/* ───────── UPDATE ───────── */
function update(){
  if(performance.now() > motion.nextDrift) drift();

  motion.vx *= 0.985;
  motion.vy *= 0.985;
  motion.x += motion.vx;
  motion.y += motion.vy;

  const speed = Math.hypot(motion.vx, motion.vy);

  particles.forEach(p=>{
    p.sway += 0.02 + speed*0.08;
    p.y += p.vy + speed*0.4;

    // string lag (this is the finesse)
    p.x += Math.sin(p.sway) * (0.3 + speed*1.2);

    if(p.y > h + 40){
      p.y = -40;
      p.x = Math.random()*w;
    }
  });
}

/* ───────── DRAW ───────── */
function draw(){
  ctx.clearRect(0,0,w,h);
  ctx.save();
  ctx.globalCompositeOperation = "lighter";

  particles.forEach(p=>{
    const dx = Math.sin(p.sway) * p.len;
    const dy = p.len;

    ctx.strokeStyle = `rgba(120,255,180,${p.alpha})`;
    ctx.lineWidth = 1;
    ctx.beginPath();
    ctx.moveTo(p.x, p.y);
    ctx.lineTo(p.x + dx, p.y + dy);
    ctx.stroke();
  });

  ctx.restore();
}

/* ───────── LOOP ───────── */
function loop(){
  update();
  draw();
  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
